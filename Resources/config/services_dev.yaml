parameters:
  fetch_metadata_policy: 

services:
  _defaults:
    autowire: true
    autoconfigure: true
  
  Ise\WebSecurityBundle\DataCollector\ReportCollector:
    public: true
    tags:
        -
          name:     data_collector
          template: '@IseWebSecurity/Collector/report.html.twig'
          id:       'ise.web_security.report_collector'
          priority: 300
  
  ise_fetch_metadata.subscriber:
    class: Ise\WebSecurityBundle\EventSubscriber\FetchMetadataRequestSubscriber
    arguments: 
      $fetchMetadataPolicy: '@Ise\WebSecurityBundle\Policies\FetchMetadataDefaultPolicy'

  Ise\WebSecurityBundle\EventSubscriber\FetchMetadataRequestSubscriber: '@ise_fetch_metadata.subscriber'

  ise_fetch_metadata.default_policy:
    class: Ise\WebSecurityBundle\Policies\FetchMetadataDefaultPolicy
    arguments:
      - $corsEndpoints

  Ise\WebSecurityBundle\Policies\FetchMetadataDefaultPolicy: '@ise_fetch_metadata.default_policy'


  Ise\WebSecurityBundle\:
      resource: '../../'
      exclude: '../../{DependencyInjection,tests,vendor}'